---
title: ä¸ºä»€ä¹ˆè¦ç”¨æ¡†æ¶
date: 2019-03-22T23:14:00
toc: false
tags: 
  - æ¡†æ¶
  - æ‚è´§é“º
---

------

ä¸€ç›´åœ¨ç”¨Vueï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰æƒ³è¿‡æ¡†æ¶çš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆç—›ç‚¹ï¼Ÿ

### å®ç°ä¸€ä¸ªç‚¹èµåŠŸèƒ½

é¦–å…ˆï¼Œå®ç°ä¸€ä¸ªç®€å•çš„ç‚¹èµåŠŸèƒ½ï¼Œä¸è€ƒè™‘ä½¿ç”¨ä»»ä½•æ¡†æ¶ã€‚

``` html
<body>
  <div class='wrapper'>
    <button class='like-btn'>
      <span class='like-text'>ç‚¹èµ</span>
      <span>ğŸ‘</span>
    </button>
  </div>

  <script>
    // å®ç°ä¸€ä¸ªç®€å•çš„ç‚¹èµæŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®çš„åŒæ—¶æŒ‰é’®çš„æ–‡å­—ä¼šå˜æ¢ã€‚demo1éš¾ä»¥å¤ç”¨
    const button = document.querySelector('.like-btn')
    const buttonText = button.querySelector('.like-text')
    let isLiked = false
    button.addEventListener('click', () => {
      isLiked = !isLiked
      if (isLiked) {
        buttonText.innerHTML = 'å–æ¶ˆ'
      } else {
        buttonText.innerHTML = 'ç‚¹èµ'
      }
    }, false)
  </script>
</body>
```

ä»¥ä¸Šä»£ç å®ç°äº†ç‚¹èµçš„åŠŸèƒ½ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜â€”â€”éš¾ä»¥å¤ç”¨ã€‚

### ç»“æ„å¤ç”¨

ç»è¿‡æ”¹é€ ï¼Œæˆ‘ä»¬ä¹Ÿä»…ä»…åªèƒ½å¤ç”¨htmléƒ¨åˆ†ï¼Œå¹¶ä¸”æ²¡æœ‰æ·»åŠ äº‹ä»¶

``` html
<body>
  <div class='wrapper'></div>

  <script>
    // ä»…ä»…å¯ä»¥å¤ç”¨htmléƒ¨åˆ†ï¼Œæ²¡æœ‰æ·»åŠ äº‹ä»¶
    class LikeButton {
      render(){
        return `
          <button id='like-btn'>
            <span class='like-text'>èµ</span>
            <span>ğŸ‘</span>
          </button>
        `
      }
    }

    const wrapper = document.querySelector('.wrapper')
    const likeButton1 = new LikeButton()
    wrapper.innerHTML = likeButton1.render()

    const likeButton2 = new LikeButton()
    wrapper.innerHTML += likeButton2.render()
  </script>
</body>
```

### æ·»åŠ äº‹ä»¶

è™½ç„¶æ·»åŠ äº†clickäº‹ä»¶ï¼Œä½†æ˜¯åªèƒ½è¾“å‡ºå›ºå®šçš„clickã€‚æˆ‘ä»¬éœ€è¦ç‚¹å‡»æŒ‰é’®ï¼Œæ”¹å˜æ–‡å­—

``` html
<body>
  <div class='wrapper'></div>

  <script>
    // æ·»åŠ äº†clickäº‹ä»¶ï¼Œä½†æ˜¯åªèƒ½æ‰“å°å›ºå®šçš„click
    // ::String => ::Document
    const createDOMFromString = (domString) => {
      const div = document.createElement('div')
      div.innerHTML = domString
      return div
    }

    class LikeButton {
      render(){
        this.el = createDOMFromString(`
          <button class='like-button'>
            <span class='like-text'>ç‚¹èµ</span>
            <span>ğŸ‘</span>
          </button>
        `)
        this.el.addEventListener('click', () => console.log('click'), false)
        return this.el
      }
    }

    const wrapper = document.querySelector('.wrapper')

    const likeButton1 = new LikeButton()
    wrapper.appendChild(likeButton1.render())

    const likeButton2 = new LikeButton()
    wrapper.appendChild(likeButton2.render())
  </script>
</body>
```

### ä¿®æ”¹æ–‡å­—

ç‚¹å‡»æŒ‰é’®ï¼Œä¼šä¿®æ”¹æ–‡å­—ï¼Œä½†æ˜¯changeLikeTextæ–¹æ³•é¢‘ç¹çš„æ“ä½œdomï¼Œå½±å“æ€§èƒ½

``` html
<body>
  <div class='wrapper'></div>

  <script>
    // ç‚¹å‡»æŒ‰é’®ä¼šæ‰§è¡ŒchangeLikeTextæ–¹æ³•ï¼Œä½†æ˜¯changeLikeTextæ–¹æ³•é‡Œé¢åœ¨ä¸åœçš„æ“ä½œdomï¼Œå½±å“æ€§èƒ½
    // ::String => ::Document
    const createDOMFromString = (domString) => {
      const div = document.createElement('div')
      div.innerHTML = domString
      return div
    }

    class LikeButton {
      constructor () {
        this.state = { isLiked: false }
      }

      changeLikeText () {
        const likeText = this.el.querySelector('.like-text')
        this.state.isLiked = !this.state.isLiked
        likeText.innerHTML = this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'
      }

      render(){
        this.el = createDOMFromString(`
          <button class='like-button'>
            <span class='like-text'>ç‚¹èµ</span>
            <span>ğŸ‘</span>
          </button>
        `)
        this.el.addEventListener('click', this.changeLikeText.bind(this), false)
        return this.el
      }
    }

    const wrapper = document.querySelector('.wrapper')

    const likeButton1 = new LikeButton()
    wrapper.appendChild(likeButton1.render())

    const likeButton2 = new LikeButton()
    wrapper.appendChild(likeButton2.render())
  </script>
</body>
```

### æ€§èƒ½ä¼˜åŒ–

åˆ°è¿™ä¸€æ­¥éª¤ï¼ŒåŸºæœ¬å·²ç»å¤§ä½“å½¢æˆï¼Œæˆ‘ä»¬å¯ä»¥åšæ›´è¿›ä¸€æ­¥çš„ä¼˜åŒ–ã€‚

``` html
<body>
  <div class='wrapper'></div>

  <script>
    // ç‚¹å‡»æŒ‰é’®æ‰§è¡ŒchangeLikeTextæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å€¼ä¼šè°ƒç”¨setStateæ–¹æ³•ï¼ŒsetStateæ–¹æ³•ä¼šé‡æ–°ç»™satateèµ‹å€¼ï¼Œå¹¶ä¸”ä¿®æ”¹è™šæ‹Ÿhtmlã€‚æœ€ç»ˆåªä¼šæ“ä½œä¸€æ¬¡dom
    // ::String => ::Document
    const createDOMFromString = (domString) => {
      const div = document.createElement('div')
      div.innerHTML = domString
      return div
    }

    class LikeButton {
      constructor () {
        this.state = { isLiked: false }
      }

      setState (state) {
        const oldEl = this.el
        this.state = state
        this.el = this.render()
        if (this.onStateChange) this.onStateChange(oldEl, this.el)
      }

      changeLikeText () {
        this.setState({
          isLiked: !this.state.isLiked
        })
      }

      render () {
        this.el = createDOMFromString(`
          <button class='like-btn'>
            <span class='like-text'>${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}</span>
            <span>ğŸ‘</span>
          </button>
        `)
        this.el.addEventListener('click', this.changeLikeText.bind(this), false)
        return this.el
      }
    }

    const wrapper = document.querySelector('.wrapper')

    const likeButton = new LikeButton()
    wrapper.appendChild(likeButton.render()) // ç¬¬ä¸€æ¬¡æ’å…¥ DOM å…ƒç´ 
    likeButton.onStateChange = (oldEl, newEl) => {
      wrapper.insertBefore(newEl, oldEl) // æ’å…¥æ–°çš„å…ƒç´ 
      wrapper.removeChild(oldEl) // åˆ é™¤æ—§çš„å…ƒç´ 
    }
  </script>
</body>
```

### è¿›ä¸€æ­¥ä¼˜åŒ–

setStateå’Œ_renderDOMå°è£…æˆComponentç±»ï¼Œä¾¿äºå…¶ä»–ç»„ä»¶ä½¿ç”¨

``` html
<body>
  <div class='wrapper'></div>

  <script>
    // æŠŠsetStateå’Œ_renderDOMæ–¹æ³•è¿›è¡ŒæŠ½ç¦»ï¼Œä¿®æ”¹domçš„æ“ä½œå°è£…æˆæ–¹æ³•
    // ::String => ::Document
    const createDOMFromString = (domString) => {
      const div = document.createElement('div')
      div.innerHTML = domString
      return div
    }

    const mount = (component, wrapper) => {
      wrapper.appendChild(component._renderDOM())
      component.onStateChange = (oldEl, newEl) => {
        wrapper.insertBefore(newEl, oldEl)
        wrapper.removeChild(oldEl)
      }
    }

    class Component {
      setState (state) {
        const oldEl = this.el
        this.state = state
        this._renderDOM()
        if (this.onStateChange) this.onStateChange(oldEl, this.el)
      }

      _renderDOM () {
        this.el = createDOMFromString(this.render())
        if (this.onClick) {
          this.el.addEventListener('click', this.onClick.bind(this), false)
        }
        return this.el
      }
    }

    class LikeButton extends Component {
      constructor () {
        super()
        this.state = { isLiked: false }
      }

      onClick () {
        this.setState({
          isLiked: !this.state.isLiked
        })
      }

      render () {
        return `
          <button class='like-btn'>
            <span class='like-text'>${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}</span>
            <span>ğŸ‘</span>
          </button>
        `
      }
    }

    const wrapper = document.querySelector('.wrapper')

    mount(new LikeButton(), wrapper)
  </script>
</body>
```

### è‡ªå®šä¹‰é…ç½®

ç»„ä»¶å¯é€šè¿‡propsä¼ å‚æ¥è‡ªå®šä¹‰é…ç½®

``` html
<body>
  <div class='wrapper'></div>

  <script>
    // ç»„ä»¶å¯ä»¥è‡ªå®šä¹‰é…ç½® é€šè¿‡props
    // ::String => ::Document
    const createDOMFromString = (domString) => {
      const div = document.createElement('div')
      div.innerHTML = domString
      return div
    }

    const mount = (component, wrapper) => {
      wrapper.appendChild(component._renderDOM())
      component.onStateChange = (oldEl, newEl) => {
        wrapper.insertBefore(newEl, oldEl)
        wrapper.removeChild(oldEl)
      }
    }

    class Component {
      constructor (props = {}) {
        this.props = props
      }

      setState (state) {
        const oldEl = this.el
        this.state = state
        this._renderDOM()
        if (this.onStateChange) this.onStateChange(oldEl, this.el)
      }

      _renderDOM () {
        this.el = createDOMFromString(this.render())
        if (this.onClick) {
          this.el.addEventListener('click', this.onClick.bind(this), false)
        }
        return this.el
      }
    }

    class LikeButton extends Component {
      constructor (props) {
        super(props)
        this.state = { isLiked: false }
      }

      onClick () {
        this.setState({
          isLiked: !this.state.isLiked
        })
      }

      render () {
        return `
          <button class='like-btn' style="background-color: ${this.props.bgColor}">
            <span class='like-text'>
              ${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}
            </span>
            <span>ğŸ‘</span>
          </button>
        `
      }
    }

    class RedBlueButton extends Component {
      constructor (props) {
        super(props)
        this.state = {
          color: 'red'
        }
      }

      onClick () {
        this.setState({
          color: 'blue'
        })
      }

      render () {
        return `
          <div style='color: ${this.state.color};'>${this.state.color}</div>
        `
      }
    }

    const wrapper = document.querySelector('.wrapper')

    mount(new LikeButton({ bgColor: 'red' }), wrapper)
  </script>
</body>
```

è¿™æ ·å­å¾ªåºæ¸è¿›çš„çœ‹ä¸‹æ¥ï¼Œå°±èƒ½ä½“ä¼šåˆ°ä¸€ä¸ªæ¡†æ¶çš„è¯ç”Ÿçš„ä¸ªä¸­ç¼˜ç”±â€”â€”å¹¶ä¸æ˜¯å¹³ç™½æ— æ•…åšå‡ºæ¥çš„ï¼Œè€Œæ˜¯ä¸ºäº†è§£å†³ä¸€äº›é—®é¢˜ï¼Œç„¶åä¸€ç‚¹ä¸€ç‚¹çš„ä¼˜åŒ–ï¼Œæœ€ç»ˆè¯ç”Ÿçš„ã€‚